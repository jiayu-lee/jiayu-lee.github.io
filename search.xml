<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Large Dynamic Covariance Matrices</title>
    <url>/2020/09/17/Large%20Dynamic%20Covariance%20Matrices/</url>
    <content><![CDATA[<p>作者：<a href="https://www.stern.nyu.edu/rengle/">Robert F.Engle</a>, Olivier Ledoit &amp; Michael Wolf<br>期刊：<a href="https://amstat.tandfonline.com/loi/jbes">Journal of Business &amp; Economic Statistics</a><br>接收：2017年6月28日</p>
<a id="more"></a>
<hr>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>收益的二阶矩对风险管理和投资组合选择很重要。而二阶矩的估计可以从两个角度考虑：  </p>
<ol>
<li>时间序列（time series）：<ul>
<li>主要考虑：条件异方差(conditional heteroscedasticity)  </li>
<li>主要模型：Dynamic Conditional Correlation (DCC), derived from the ARCH/GARCH family started by Engle (1982).  </li>
</ul>
</li>
<li>横截面（the cross-section）：<ul>
<li>主要考虑：纠正样本协方差矩阵特征值的样本内方差（correct in-sample biases of sample covariance matrix eigenvalues）  </li>
<li>主要模型：非线性收缩（nonlinear shrinkage）, derived from Random Matrix Theory (RMT)    </li>
</ul>
</li>
</ol>
<p>这篇文章结合了这两个方法，提出大动态协方差矩阵的改进估计。<br>Matlab code implementing the DCC model based on nonlinear shrinkage can be <a href="http://www.econ.uzh.ch/en/people/faculty/wolf/publications.html">downloaded</a> under the link “Programming Code.”</p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><strong>提出原因</strong>：基于ARCH/GARCH模型(Engle,1982)的多元GARCH模型在高维表现不佳。<br><strong>本文目的</strong>：基于大维度，对DCC模型（Engle,2002)进行改进。为此使用了两个工具：  </p>
<ul>
<li>Pakel et al.(2014)提出的复合似然法（composite likelihood method）：保证估计大维度DCC在计算上的可能性；  </li>
<li>Ledoit and Wolf (2012)提出的非线性收缩（nonlinear shrinkage）：改进了目标矩阵的估计，使得DCC在资产数量较大时表现良好；  </li>
</ul>
<p><strong>本文贡献</strong>：确定了如何在DCC模型中更好的应用非线性收缩：在截距矩阵中而不是在估计条件协方差过程中使用非线性收缩；此外改进了估计GARCH动态参数的代码包，增加了可处理的资产数量。<br>相关文献：Hafner and Reznikova(2012)；差别在于他们没有使用第一个工具——复合似然，使用的线性收缩而不是非线性收缩。他们实证只涉及100维，本文1000维。</p>
<p><strong>文章结构</strong>：第2节介绍了DCC模型，包括复合似然法；第3节介绍了非线性收缩；第4节介绍了为投资组合选择问题定制的损失函数；第5节包含蒙特卡罗模拟；第6节基于实际数据回溯测试；第7节对BEKK(Engle &amp; Kroner,1995) 进行了拓展；第8节总结；第9节补充提供了关于非线性的额外细节和动机。</p>
<h2 id="The-DCC-Model"><a href="#The-DCC-Model" class="headerlink" title="The DCC Model"></a>The DCC Model</h2><p>base:Engle(2002) and Engle(2009, sec. 11.2)</p>
<h3 id="Notation"><a href="#Notation" class="headerlink" title="Notation"></a>Notation</h3><p>$ i \in (1,N);$ 其中 $N$ 是协方差矩阵的维度。<br>$ t \in (1,T);$ 其中 $T$ 是样本量。</p>
<ul>
<li>$r_{i,t}:$：变量 $i$ 在 $t$ 时刻的观测数据，${\bf{r}}_t:=(r_{1,t},…,r_{N,t})$</li>
<li>$d_{i,t}^2 := var(r_{i,t}|\mathcal{F}_{t-1}):$ 第$i$个变量在$t$时刻的条件方差。</li>
<li>$D_t$ 是$N$ 维对角矩阵，其对角元素为$d_{i,t}$</li>
<li>$H_t := cov({\bf{r}}_t|\mathcal{F})$：在$t$时刻的条件协方差矩阵；因此有$Diag(H_t) = D_t^2$</li>
<li>$s_{i,t} := r_{i,t} / d_{i,t}$： 数据除以条件标准差进行标准化。${\bf{s}}_t := (s_{1,t},…,s_{N,t})’$</li>
<li>$R_t:=Corr({\bf{r}}_t|\mathcal{F}_{t-1})=cov({\bf{s}}_t|\mathcal{F}_{t-1})$：在$t$条件关系矩阵。PS:经标准化的样本数据的协方差矩阵就是原始样本数据的相关矩阵。</li>
<li>$\sigma_i^2 := E(d_{i,t}^2) = var(r_{i,t})$：第i个序列的无条件方差。</li>
<li>$C := Corr({\bf{r}}_t) = cov({\bf{s}}_t)$：无条件相关矩阵。</li>
</ul>
<h3 id="Model-Definition"><a href="#Model-Definition" class="headerlink" title="Model Definition"></a>Model Definition</h3><p>对于单变量动态波动模型，我们选择了$GARCH(1,1)$过程：</p>
<script type="math/tex; mode=display">d_{i,t}^2 = \omega + a_ir_{i,t-1}^2 + b_i d_{i,t-1}^2,  \tag{2.1}</script><p>其中$(\omega_i,a_i,b_i)$是$GARCH(1,1)$过程的参数。</p>
<p>我们假设相关矩阵随时间的变化可以由关联目标化的DCC模型描述，改编自Engle &amp; Mezrich(1996)的variance targeting:见 eq.(11.7) of Engle(2009).本文中表述为：</p>
<script type="math/tex; mode=display">Q_t = (1 - \alpha - \beta)C + \alpha s_{t-1} s_{t-1}' + \beta Q_{t-1} \tag{2.2}</script><p>其中$(\alpha ,\beta)$类似于DCC中的参数$(a_i,b_i)$，但是$(\alpha ,\beta)$是在相关空间而不是方差空间。矩阵$Q_t$可以解释为一个条件伪相关矩阵，或者条件协方差矩阵的devolatized残差。由于它对角元素虽然接近于1但是不等于1，所以不能直接使用。从而有条件相关矩阵和条件协方差矩阵：</p>
<script type="math/tex; mode=display">R_t = Diag(Q_t)^{-1/2}Q_tDiag(Q_t)^{-1/2} \tag{2.3}</script><script type="math/tex; mode=display">H_t = D_tR_tD_t \tag{2.4}</script><p>数据生成过程遵循以下多元正态分布：</p>
<script type="math/tex; mode=display">{\bf{r}}_t|\mathcal{F}_{t-1} ~ \mathcal{N}(0,H_t) \tag{2.5}</script><p>remark2:Aielli (2013)说以上DCC基础模型存在估计的一致性问题，并提出了cDCC，但是这个不影响实际应用，如果影响，为了简化我们还是用基础的。</p>
<h3 id="Estimation-in-Large-Dimensions"><a href="#Estimation-in-Large-Dimensions" class="headerlink" title="Estimation in Large Dimensions"></a>Estimation in Large Dimensions</h3><p>DCC大于大量资产的估计是有难度的，其一是对条件协方差矩阵$H_t$(for $t =1,…,T$)对数似然函数求逆。所幸 Pakel et al.(2014)提出的复合似然法。其基本思想是，与其把所有资产放在一起看，不如看成对的资产更容易，通过成对资产的对数似然求和计算。<br>在作者提出的各种变体中，最可扩展的是$2MSCLE$方法，它基于所有相邻对计算复合似然估计。因此，只有$N-1$双变量对数概率可供计算。作者表明这样构造的复合（对数）似然能产生对$(\alpha ,\beta)$的一致估计量，哪怕不是有效的。<br>估计过程分为以下三部分：   </p>
<ol>
<li>对于每一项资产，拟合单变量$GARCH(1,1)$模型，并使用拟合模型传递收益序列。</li>
<li>估计无条件相关矩阵，并将其用于相关目标</li>
<li>最大化综合似然从而估计相关动态。<br>从下一节开始，本文的重点是改进第二步。</li>
</ol>
<p>remark3:公式2.5的正态分布不是关键假设，如果不成立，复合（似然）估计变成准(quasi)复合（似然）估计。该估计方法性质良好且被普遍接受，例如Hamilton(1994,sec. 5.3)</p>
<h2 id="LARGE-UNCONDITIONAL-CORRELATION-MATRICES"><a href="#LARGE-UNCONDITIONAL-CORRELATION-MATRICES" class="headerlink" title="LARGE UNCONDITIONAL CORRELATION MATRICES"></a>LARGE UNCONDITIONAL CORRELATION MATRICES</h2><p>$DCC$模型的时间序列方法满足随机矩阵理论（RMT）截面结果的关键是对无条件相关矩阵C的估计，该矩阵作为公式$(2.2)$中ARCH/GARCH dynamics的目标或者说截距。</p>
<h3 id="Sample-Correlation-Matrix"><a href="#Sample-Correlation-Matrix" class="headerlink" title="Sample Correlation Matrix"></a>Sample Correlation Matrix</h3><p>人们普遍认为，样本相关矩阵在大维度情况下表现不佳。Michaud(1989)将投资组合优化描述为错误最大化。样本相关矩阵（和协方差）矩阵在样本内是一种很好的拟合方法，但是在样本外却存在过拟合的问题。投资组合经历在样本外投资，因此在决策时应尽量避免样本相关矩阵。<br>因为样本相关矩阵有$N(N-1)/2$个参数，数据集有$N * T$ 个有噪观测。当N与T数量级相同时，这两个量大小相似。从$O(N^2)$个噪声数据点钟准确的估计$O(N^2)$是不可能的：这就是维数的诅咒。<br>RMT告诉我们N/T是决定因素,N/T通常称为浓度（比率），如果浓度很小，比如说小于1/100，那么标准渐进（固定维度的）能表示真实行为的一个很好的近似，并且样本相关矩阵在样本外可信。随着浓度的增加，需要采用特殊方法来解决自由参数过多导致的样本内过拟合问题。<br>最极端好理解的例子是当N/T超过1时，资产比时间序列观测多，此时样本相关矩阵是奇异的。在这种情况下，伪逆会导致最优资产组合权重为正负无穷，这显然是经济上不正确的解。从连续性的角度看，当N趋近于T时，问题就开始出现了。实际上，RMT的主要教训是，除非N/T可以忽略不计，否则样本相关矩阵（和协方差矩阵）将在样本外系统表现失常。</p>
<h3 id="Shrinkage-Estimator"><a href="#Shrinkage-Estimator" class="headerlink" title="Shrinkage Estimator"></a>Shrinkage Estimator</h3><p>由于过拟合，现在可以对样本相关（协方差）矩阵的样本内偏差进行校正。这种校正发生在特征值的水平上。小样本特征值太小，大样本特征值太大，所以就是把小的推上去把大的拉下来。由于这种变换减少了特征值的横截面分布的拓展，一般称为收缩。<br>在本文中将关注Ledoit &amp; Wolf (2012)的非线性收缩公式。$\Sigma$表示总协方差矩阵，$S$表示样本协方差矩阵，$u$表示S的特征向量。通过基础线性代数，对应的样本特征值等于$u’Su$。它是权重由向量u给出的投资组合的样本内方差，也是由于过拟合需要矫正的量。非线性收缩需要取代$u’Su$，估计同一资产组合的样本外方差(a consistent estimator of) $u’ \Sigma u$。很显然，我们想根据真实的样本外风险$u’ \Sigma u$，而不是样本内方差$u’Su$决定我们资产组合配置的方向向量$u$。使用$u’Su$会由于维度的诅咒产生严重的偏见。<br>如果我们不知道$\Sigma$，我们怎么知道$u’\Sigma u$ ？然而Ledoit and Péché (2011)表明，我们不需要知道所有的真实协方差矩阵$\Sigma$，而是可以仅仅知道他的特征值。特征值只有$N$个。给定$N\times T$维的数据集，不可能准确的估计$N*N$维的矩阵，但是理论上是可以估计$N$个特征值的。参数与数据的比率$1/T$是一个很小的数字，不论$N$有多大。<br>根据样本特征值估计总体特征值需要颠倒Marcenko and Pastur (1967)的方程，保证当维度增大时控制渐进关系。El Karoui (2008) and Mestre (2008)是第一个在这方面进行尝试的人。他们提出的解决办法有一些局限性，不适合普遍使用。随后，Ledoit and Wolf(2015)提出了一种有效的方法——基于对他们称之为QuEST(quantized eigenvalues sampling transform) function进行数值反演(numerical inversion)。 QuEST是一个不可逆的N维函数，对Marcenko–Pastur等式进行离散，使其有助于数值反演。这就是本文使用到的方法。<br>这篇文章的基本思想就是利用Ledoit and Wolf的非线性收缩估计器去估计公式2.2中的相关目标矩阵C，而不是样本相关矩阵。当维度N较大切与样本容量T的数量级相同时，该方法生成了一个条件协方差矩阵$H_t$的估计量，该估计量具有更好的样本外性质。</p>
<h3 id="数学公式"><a href="#数学公式" class="headerlink" title="数学公式"></a>数学公式</h3><p>$S := [s_{i,t}]$代表$N * T$ 维devolatilized收益矩阵。假设其均值为0，那么样本方差矩阵为：</p>
<script type="math/tex; mode=display">\hat{C} := \frac{T}{1} S S' \tag{3.1}</script><p>分解$\hat{C}$得到一组降序排序并不失一般性的特征值$(\lambda_1,\lambda_2,…,\lambda_N)$，以及对应的特征向量$(u_1,u_2,…,u_N)$，因此：</p>
<script type="math/tex; mode=display">\hat{C} := \sum\limits_{i=1}^{N} \lambda_i u_iu_i'</script>]]></content>
      <tags>
        <tag>covariance</tag>
      </tags>
  </entry>
</search>
